enum PlanType {
  FREE
  STANDARD
  PREMIUM
  ENTERPRISE
  DIGITAL_DEMOCRACY

  @@schema("armonia")
}

model Plan {
  id          Int      @id @default(autoincrement())
  name        String   @unique
  description String?
  price       Decimal  @db.Decimal(10, 2)
  planType    PlanType
  maxUnits    Int?     // Max residential units for this plan
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  features    Feature[]
  subscriptions Subscription[]

  @@index([planType])
}

model Feature {
  id          Int      @id @default(autoincrement())
  name        String
  description String?
  planId      Int
  plan        Plan     @relation(fields: [planId], references: [id])
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@index([planId])
}

model Subscription {
  id          Int      @id @default(autoincrement())
  complexId   Int      @unique
  complex     ResidentialComplex @relation(fields: [complexId], references: [id])
  planId      Int
  plan        Plan     @relation(fields: [planId], references: [id])
  startDate   DateTime @default(now())
  endDate     DateTime
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@index([complexId])
  @@index([planId])
  @@index([isActive])
}
