enum ReservationStatus {
  PENDING
  APPROVED
  REJECTED
  CANCELLED
  COMPLETED
}

enum CommonAreaType {
  SALON
  BBQ
  COURT
  POOL
  GYM
  OTHER
}

model CommonArea {
  id                Int           @id @default(autoincrement())
  name              String
  description       String?
  type              CommonAreaType
  capacity          Int?
  requiresApproval  Boolean       @default(false)
  hourlyRate        Float?
  availableDays     String[]      // e.g., ["MONDAY", "TUESDAY"]
  openingTime       String?       // e.g., "08:00"
  closingTime       String?       // e.g., "22:00"
  complexId         Int
  complex           ResidentialComplex @relation(fields: [complexId], references: [id])
  reservations      Reservation[]
  createdAt         DateTime      @default(now())
  updatedAt         DateTime      @updatedAt

  @@unique([complexId, name])
  @@index([complexId])
}

model Reservation {
  id                Int             @id @default(autoincrement())
  commonAreaId      Int
  commonArea        CommonArea      @relation(fields: [commonAreaId], references: [id])
  userId            Int
  user              User            @relation(fields: [userId], references: [id])
  title             String
  description       String?
  startDateTime     DateTime
  endDateTime       DateTime
  status            ReservationStatus @default(PENDING)
  attendees         Int?
  requiresPayment   Boolean         @default(false)
  paymentAmount     Float?
  paymentStatus     String? // e.g., "PAID", "PENDING", "FAILED"
  rejectionReason   String?
  approvedById      Int?
  approvedBy        User?           @relation("ApprovedReservations", fields: [approvedById], references: [id])
  approvedAt        DateTime?
  cancellationReason String?
  cancelledAt       DateTime?
  createdAt         DateTime        @default(now())
  updatedAt         DateTime        @updatedAt

  @@index([commonAreaId])
  @@index([userId])
  @@index([status])
  @@index([startDateTime])
}