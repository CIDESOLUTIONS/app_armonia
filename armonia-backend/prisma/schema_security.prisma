enum SecurityEventType {
  LOGIN_SUCCESS
  LOGIN_FAILURE
  PASSWORD_CHANGE
  ROLE_CHANGE
  DATA_ACCESS
  SYSTEM_ERROR
  OTHER

  @@schema("tenant")
}

model SecurityLog {
  id          Int               @id @default(autoincrement())
  complexId   Int
  complex     ResidentialComplex @relation(fields: [complexId], references: [id])
  userId      Int?
  user        User?             @relation(fields: [userId], references: [id])
  eventType   SecurityEventType
  description String
  ipAddress   String?
  userAgent   String?
  timestamp   DateTime          @default(now())
  details     Json?             // Additional details in JSON format

  @@index([complexId])
  @@index([userId])
  @@index([eventType])
  @@index([timestamp])
  @@schema("tenant")
}

model AccessAttempt {
  id          Int      @id @default(autoincrement())
  userId      Int?
  user        User?    @relation("AccessAttempts", fields: [userId], references: [id])
  ipAddress   String
  userAgent   String?
  timestamp   DateTime @default(now())
  success     Boolean
  reason      String?  // e.g., 'Invalid credentials', 'Account locked'

  @@index([userId])
  @@index([ipAddress])
  @@index([timestamp])
  @@index([success])
  @@schema("tenant")
}